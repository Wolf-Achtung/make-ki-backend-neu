<!doctype html>
<html lang="{{ (meta.lang or 'en') }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ (meta.title or 'AI Status Report') }}</title>

  <style>
  /* ==========================================================================
     AI Status Report ‚Äì Dark Blue Palette
     Version: 2025‚Äë09‚Äë21
     ========================================================================== */
  :root{
    --blue-950: #0a1220;
    --blue-900: #0b1f3b;
    --blue-850: #123056;
    --blue-800: #153a6b;
    --blue-700: #1f4d8f;
    --blue-600: #2a66b2;
    --blue-500: #3a7bd5;
    --blue-200: #dbe8fb;
    --blue-150: #e8f0ff;
    --blue-100: #f2f6ff;

    --ink:        var(--blue-900);
    --ink-weak:   #3f5575;
    --muted:      #5c6d84;
    --border:     #d6e0ef;
    --bg:         #ffffff;
    --soft-bg:    #f6f9ff;

    --success: #19724f;
    --warning: #b45309;
    --danger:  #b91c1c;

    --base-size: 11.5pt;
    --line:      1.60;
    --h1:        26pt;
    --h2:        18pt;
    --h3:        14pt;
    --space-1:   6pt;
    --space-2:   10pt;
    --space-3:   16pt;
    --space-4:   22pt;
    --radius:    6px;
    --shadow:    0 1px 0 rgba(10,16,32,.04), 0 0 0 1px rgba(10,16,32,.04);
  }

  html, body{
    background: var(--bg);
    color: var(--ink);
    font: normal var(--base-size)/var(--line) "Inter","SF Pro Text","Segoe UI",
          Roboto,"Helvetica Neue",Arial,system-ui,-apple-system,sans-serif;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
    margin: 0;
  }

  .page{ page-break-after: always; }
  .page:last-child{ page-break-after: auto; }

  .wrapper{
    max-width: 800px;
    margin: 0 auto;
    padding: 24pt 28pt 28pt;
  }

  h1, h2, h3{
    color: var(--ink);
    margin: 0 0 var(--space-2);
    line-height: 1.25;
    letter-spacing: .1px;
  }
  h1{ font-size: var(--h1); font-weight: 700; color: var(--blue-900); }
  h2{ font-size: var(--h2); font-weight: 700; }
  h3{ font-size: var(--h3); font-weight: 700; color: var(--blue-850); }

  p{ margin: 0 0 var(--space-2); widows: 2; orphans: 2; }
  small, .muted{ color: var(--muted); }

  a{ color: var(--blue-700); text-decoration: none; }
  a:hover{ text-decoration: underline; }

  .section-title{
    display: flex; align-items: center;
    gap: 10pt; margin: var(--space-4) 0 var(--space-2);
  }
  .section-title .dot{
    width: 22px; height: 22px; border-radius: 6px;
    background: linear-gradient(180deg, var(--blue-700), var(--blue-500));
    box-shadow: 0 2px 6px rgba(21,58,107,.20);
  }
  .section-title h2{ margin: 0; }

  .hr{ height: 1px; background: var(--border); margin: var(--space-3) 0 var(--space-2); }

  .cover{ padding: 48pt 0 10pt; }
  .kicker{ text-transform: uppercase; letter-spacing: .6px; color: var(--ink-weak); font-weight: 700; }
  .lead{ font-size: 13.5pt; color: var(--ink); }

  .meta{
    display: grid; grid-template-columns: auto 1fr;
    gap: 6pt 12pt; margin: var(--space-2) 0 var(--space-3);
    color: var(--ink-weak);
  }
  .meta b{ color: var(--ink); }

  .toc{
    background: var(--blue-100);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 14pt 16pt;
    margin: var(--space-3) 0;
  }
  .toc h3{ margin-top: 0; }
  .toc ol{ margin: 0; padding-left: 18pt; }
  .toc li{ margin: 4pt 0; }

  .callout{
    border: 1px solid var(--border);
    border-left: 4px solid var(--blue-700);
    border-radius: var(--radius);
    background: var(--blue-100);
    padding: 12pt 14pt;
    box-shadow: var(--shadow);
    margin: var(--space-2) 0 var(--space-3);
  }
  .callout.safe{ border-left-color: var(--success); background: #eef9f4; }
  .callout.risk{ border-left-color: var(--warning); background: #fff6ea; }
  .callout h3{ margin-top: 0; }

  .table{
    width: 100%; border-collapse: collapse; margin: var(--space-2) 0 var(--space-3);
    font-size: 10.5pt;
  }
  .table thead th{
    background: var(--blue-800); color: #fff; font-weight: 700;
    text-align: left; padding: 9pt 10pt; border: 1px solid var(--blue-800);
  }
  .table tbody td{
    padding: 8pt 10pt; border: 1px solid var(--border);
    vertical-align: top;
  }
  .table tbody tr:nth-child(even){ background: var(--blue-150); }
  .table caption{
    text-align: left; font-weight: 700; color: var(--blue-850);
    margin: 0 0 6pt;
  }
  .table.tools   caption::before{ content: "üîß "; }
  .table.funding caption::before{ content: "üí∂ "; }

  ul, ol{ margin: 0 0 var(--space-2) 16pt; }
  li{ margin: 3pt 0; }

  .footer{
    margin-top: var(--space-4);
    padding-top: var(--space-2);
    border-top: 1px solid var(--border);
    color: var(--muted);
    font-size: 10pt;
    display: flex; justify-content: space-between; gap: 10pt; flex-wrap: wrap;
  }

  .page-break{ page-break-before: always; }

  @media print{
    a{ text-decoration: none; }
    .toc, .callout, .table{ break-inside: avoid; }
  }
  </style>
</head>
<body>
  {% set _today = (meta.date or now().date().isoformat()) %}
  <div class="page">
    <div class="wrapper">
      <div class="cover">
        <div class="kicker">
          Narrative report ‚Äì GDPR &amp; EU AI Act ready. {{ _today }}
          ¬∑ Industry: {{ meta.industry or '‚Äî' }} ¬∑ Size: {{ meta.size or '‚Äî' }} ¬∑ Location: {{ meta.region or '‚Äî' }}
          ¬∑ Language: {{ (meta.lang or 'EN')|upper }}
        </div>
        <h1>AI Status Report</h1>
        <p class="lead">Created with curated prompts and an optional live layer for tools &amp; funding.
          <a href="https://make.ki-sicherheit.jetzt/feedback/feedback.html">Give feedback</a>.
        </p>

        <div class="meta">
          <div><b>Title</b></div><div>{{ meta.title or 'AI Status Report' }}</div>
          <div><b>Date</b></div><div>{{ _today }}</div>
          <div><b>Contact</b></div><div>{{ meta.contact or '‚Äî' }}</div>
          <div><b>Hosting preference</b></div><div>{{ meta.hosting or 'EU options preferred' }}</div>
        </div>

        <div class="toc">
          <h3>Table of contents</h3>
          <ol>
            {% for s in sections or [] %}
              <li>{{ s.title }}</li>
            {% endfor %}
            {% if (tables and tables.tools) %}<li>Tools (EU options)</li>{% endif %}
            {% if (tables and tables.funding) %}<li>Funding programmes (selection)</li>{% endif %}
          </ol>
        </div>
      </div>

      <div class="footer">
        <div>¬© {{ now().year }} Wolf Hohl ¬∑ KI‚ÄëSicherheit ¬∑ GDPR &amp; EU AI Act ready</div>
        <div><a href="https://make.ki-sicherheit.jetzt/feedback/feedback.html">Feedback</a> ¬∑
             ‚ÄúHow was this report created?‚Äù ‚Äì curated prompts, live layer (optional), EU options, human review.</div>
      </div>
    </div>
  </div>

  {% macro render_table(t, cls) -%}
    {% if t and t.headers and t.rows %}
      <table class="table {{ cls }}">
        {% if t.caption %}<caption>{{ t.caption }}</caption>{% endif %}
        <thead><tr>
          {% for h in t.headers %}<th>{{ h }}</th>{% endfor %}
        </tr></thead>
        <tbody>
          {% for row in t.rows %}
            <tr>
              {% for cell in row %}
                <td>{{ cell | safe }}</td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}
  {%- endmacro %}

  {% for s in sections or [] %}
    <div class="page">
      <div class="wrapper">
        <div class="section-title">
          <div class="dot"></div>
          <h2>{{ s.title }}</h2>
        </div>
        <div class="hr"></div>
        <div class="section-body">
          {{ s.html | safe }}
        </div>

        {% if loop.last and (tables and (tables.tools or tables.funding)) %}
          <div class="section-title">
            <div class="dot"></div>
            <h2>Tables &amp; overviews</h2>
          </div>
          <div class="hr"></div>
          {{ render_table(tables.tools, 'tools') }}
          {{ render_table(tables.funding, 'funding') }}
        {% endif %}

        <div class="footer">
          <div>¬© {{ now().year }} Wolf Hohl ¬∑ KI‚ÄëSicherheit ¬∑ GDPR &amp; EU AI Act ready</div>
          <div><a href="https://make.ki-sicherheit.jetzt/feedback/feedback.html">Feedback</a> ¬∑
               ‚ÄúHow was this report created?‚Äù ‚Äì curated prompts, live layer (optional), EU options, human review.</div>
        </div>
      </div>
    </div>
  {% endfor %}

  {% if not sections or sections|length == 0 %}
    <div class="page">
      <div class="wrapper">
        <div class="section-title">
          <div class="dot"></div>
          <h2>Executive summary</h2>
        </div>
        <div class="hr"></div>
        <p>This report could not be generated completely. A narrative fallback was activated
           so you still receive a usable result. Please recheck the questionnaire inputs
           (especially industry, size, and location) and try again.</p>

        <div class="footer">
          <div>¬© {{ now().year }} Wolf Hohl ¬∑ KI‚ÄëSicherheit ¬∑ GDPR &amp; EU AI Act ready</div>
          <div><a href="https://make.ki-sicherheit.jetzt/feedback/feedback.html">Feedback</a> ¬∑
               ‚ÄúHow was this report created?‚Äù ‚Äì curated prompts, live layer (optional), EU options, human review.</div>
        </div>
      </div>
    </div>
  {% endif %}
</body>
</html>
