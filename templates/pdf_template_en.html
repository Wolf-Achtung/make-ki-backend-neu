<!doctype html>
    <html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>AI Readiness Report</title>
      <style>
        :root{ --brand-blue:#0B314F; --brand-green:#62C6A4; --ink:#0a122a; 
--muted:#5b6b7a; --bg:#f6f9fc; --card:#ffffff; --border:#e5ecf4; }
        *{box-sizing:border-box}
        html,body{margin:0;padding:0;font:15px/1.65 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:var(--bg)}
        h1,h2,h3{
          margin:0 0 .6rem 0;
          font-weight:700;
        }
        /* Enlarge headings and add spacing */
        h1{
          font-size:36px;
          margin-bottom:1rem;
        }
        h2{
          font-size:26px;
          border-bottom:2px solid var(--border);
          padding-bottom:.6rem;
          margin-top:1.8rem;
          margin-bottom:.8rem;
        }
        h3{
          font-size:20px;
          margin:1.2rem 0 .6rem;
        }
        p{
          /* Provide more breathing room and a comfortable line height */
          margin:.6rem 0;
          line-height:1.7;
        }
        small,em{color:#6b7280}
        ul,ol{margin:.4rem 0 .6rem 1.2rem} a{color:var(--brand-blue);text-
decoration:none;border-bottom:1px solid rgba(31,102,255,.35)}
        .container{padding:22px}
.header{display:flex;align-items:center;justify-content:space-between;background:var(--card);color:var(--ink);border-bottom:2px solid var(--brand-blue)}
        .header .inner{display:flex;gap:16px;align-items:center;padding:14px 
22px}
        .header img{height:38px}
        .badge{margin-left:auto;opacity:.95}
.meta{display:flex;gap:18px;flex-wrap:wrap;color:var(--muted);font-size:12px}
        .card{
          background:var(--card);
          border:1px solid var(--border);
          border-left:4px solid var(--brand-blue);
          border-radius:14px;
          padding:24px;
          box-shadow:0 2px 6px rgba(0,0,0,0.05);
        }
        .grid{display:grid;gap:14px}
.grid.cols-2{grid-template-columns:1fr 1fr}
        .footer{margin-top:18px;padding-top:8px;border-top:1px dashed 
var(--border);font-size:12px;color:#6b7280}
        table{width:100%;border-collapse:collapse;margin:.4rem 0}
        th,td{border:1px solid var(--border);padding:8px;text-
align:left;vertical-align:top}
        th{background:var(--brand-blue);color:#fff}
        .svgbox{background:var(--card);border:1px solid var(--border);border-
radius:14px;padding:10px}
        .caption{font-size:12px;color:#6b7280;margin-top:.25rem}
        .toc-card{background:var(--card);border:1px dashed var(--border);border-
radius:14px;padding:14px}
        .vision-card{background:linear-gradient(180deg, rgba(24,169,153,.08), 
rgba(31,102,255,.08));border:1px solid rgba(31,102,255,.25);border-left:4px 
solid var(--brand-blue);border-radius:12px;padding:14px;}
        .timeline{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
        .t-card{background:var(--card);border:1px solid var(--border);border-
radius:12px;padding:12px}
        .t-title{font-weight:700;margin-bottom:.2rem}
        /* KPI Tiles */
        .kpi-grid{display:grid;grid-template-columns:repeat(auto-
fit,minmax(110px,1fr));gap:12px;margin-top:.6rem}
        .kpi-item{border:1px solid var(--border);border-radius:12px;padding:10px;text-align:center}
        /* Colourful KPI cards: use brand colours for up to four metrics */
        .kpi-item:nth-child(1){background:var(--brand-blue);color:#fff;}
        .kpi-item:nth-child(2){background:#355E8C;color:#fff;}
        .kpi-item:nth-child(3){background:var(--brand-green);color:#fff;}
        .kpi-item:nth-child(4){background:#A0D9C9;color:#fff;}
        .kpi-item .kpi-value{font-size:20px;font-weight:700;margin-bottom:2px}
        /* Hide KPI labels in the gold standard: the descriptive texts are
           summarised in sentences in the executive summary.  This prevents
           stray single-word lines (e.g. "Digitalization", "Automation")
           from appearing in the PDF text extraction. */
        .kpi-item .kpi-label{
          font-size:0;
          line-height:0;
          opacity:0;
        }
        /* Benchmark bars */
        .benchmark-bars{margin-top:.6rem}
        .benchmark-row{display:flex;align-items:center;margin-bottom:6px;font-size:12px}
        .benchmark-label{width:90px;color:#6b7280;font-weight:500}
        /* Container: grey background and relative positioning */
        .benchmark-bar{flex:1;height:8px;background:#e5ecf4;border-radius:4px;position:relative;overflow:hidden}
        /* Blue bar representing your value: relative so width style works */
        .benchmark-bar span.you{
          /* Render the own-value bar as an absolutely positioned element so the
             inline width (set via style="width:XX%;") takes effect. */
          display:block;
          position:absolute;
          left:0;
          top:0;
          height:8px;
          background:var(--brand-blue);
          border-radius:4px;
          z-index:1;
        }
        /* Green marker for industry benchmark */
        .benchmark-bar span.avg{
          position:absolute;
          top:-3px;
          width:2px;
          height:14px;
          background:var(--brand-green);
          z-index:2;
        }
        /* Risk heatmap */
        .risk-table{width:100%;border-collapse:collapse;margin-top:.6rem;font-
size:12px}
        .risk-table th,.risk-table td{border:1px solid 
var(--border);padding:6px;text-align:center}
        .risk-table th{background:var(--brand-blue);color:#fff}
        .risk-low{background:#e5f3ff}
        .risk-mid{background:#fff7e6}
        .risk-high{background:#ffe5e5}
        /* Funding badges */
        .funding-badges{margin-top:.5rem;display:flex;flex-wrap:wrap;gap:6px}
        .funding-badge{padding:4px 8px;border-radius:8px;background:var(--brand-
blue);color:#fff;font-size:10px;white-space:nowrap}
        /* KPI badges */
        .kpi-badges{margin-top:.35rem;display:flex;flex-wrap:wrap;gap:6px}
        .kpi-badge{padding:4px 8px;border-radius:8px;font-size:10px;white-space:nowrap;border:1px solid var(--border)}
        /* Status colours: unify English and German classes */
        .kpi-lead,.kpi-vorsprung{background:#E6F4EA;color:#14532d;border-color:#bbdec4}
        .kpi-on-par,.kpi-gleichauf{background:#EFF6FF;color:#1e3a8a;border-color:#cfe3ff}
        .kpi-behind,.kpi-rueckstand,.kpi-ruckstand{background:#FEE2E2;color:#7f1d1d;border-color:#f5c2c2}
        /* Smaller badges for TOC */
        .kpi-badges--toc .kpi-badge{font-size:9px;opacity:.9}
    thead { display: table-header-group; }
    tr { page-break-inside: avoid; }
    /* Prevent awkward line breaks within hyperlinks: force URLs to stay on
       one line and disable hyphenation.  This keeps tool names and links
       intact in the generated PDF. */
    a {
      white-space: nowrap;
      word-break: normal;
      hyphens: none;
    }

    /* Ensure the Executive summary card spans the full available width on onepager pages */
    .onepager > .card {
      width: 100%;
    }
      .footnote { page-break-inside: avoid; page-break-after: avoid; margin-top: .2rem; font-size: 9px; color: var(--muted); }
</style>
    <style>
.risk-low{background:#D7F3E8!important;}
.risk-mid{background:#CFE3FF!important;}
.risk-high{background:#0D3B66!important;color:#fff!important;}
.footnote { page-break-inside: avoid; page-break-after: avoid; margin-top: .2rem; font-size: 9px; color: var(--muted); }
</style>
<style>
/* New layout rules: each section starts on a new page and has generous spacing */
.section{
  page-break-before: always;
  break-before: page;
  margin-top: 2rem;
}
.footnote { page-break-inside: avoid; page-break-after: avoid; margin-top: .2rem; font-size: 9px; color: var(--muted); }
</style>
</head>
    <body>
      <div class="header">
        <div class="inner">
          {% if logo_main %}<img src="{{ logo_main }}" alt="KI-Sicherheit" />{% 
endif %}
          <div>
            <h1>AI Readiness Report 2025</h1>
            <div class="meta"><div>Date: {{ today }}</div><div>Language: 
EN</div></div>
          </div>
          <div class="badge">{% if badge_ready %}<img src="{{ badge_ready }}" 
alt="Badge" style="height:38px">{% endif %}</div>
        </div>
      </div>

      <div class="container">
        <!-- Cover: Gauge -->
        <div class="card">
          <h2>Your AI-readiness at a glance</h2>

          {% if preface %}<div style="margin-top:.6rem">{{ preface|safe 
}}</div>{% endif %}
          {% if kpis and kpis|length > 0 %}
            {# KPI tiles removed in the Gold‑Standard.  KPI overview appears only in the Executive summary. #}
          {% endif %}
        </div>

        {% if toc_html and toc_html|trim %}
          <div class="card toc-card">
            <h2>Table of contents</h2>
            {{ toc_html|safe }}
    {# KPI badges removed in Gold‑Standard #}
          </div>
        {% endif %}

        <!-- One-Pager: Executive summary only -->
        <div class="onepager">
          {# Executive summary card #}
          {% if exec_summary_html and exec_summary_html|trim %}
          <div class="card">
            <h2>Executive summary</h2>
            <div class="exec-content" style="margin-top:.6rem">
              {{ exec_summary_html|safe }}
            </div>
          </div>
          {% endif %}
        </div>

        {% if (quick_wins_html and quick_wins_html|trim) or (risks_html and 
risks_html|trim) %}
        <div class="grid cols-2 section">
          <div class="card"><h2>Quick wins</h2><div>{{ (quick_wins_html or 
 '')|safe }}</div></div>
          <div class="card"><h2>Key risks</h2><div>{{ (risks_html or '')|safe
  }}</div></div>
        </div>
        {% endif %}
        <div class="grid cols-2 section">
          {% if recommendations_html and recommendations_html|trim %}
            <div class="card"><h2>Recommendations</h2><div>{{ 
 recommendations_html|safe }}</div></div>
          {% endif %}
          {% if roadmap_html and roadmap_html|trim or (roadmap_items and roadmap_items|length > 0) %}
            <div class="card"><h2>Roadmap</h2>
              {% if timeline and (timeline.t30 or timeline.t90 or timeline.t365) %}
              <div class="swimlane">
                <div>
                  <h3>Short term</h3>
                  {% for it in timeline.t30 %}<p>{{ it }}</p>{% endfor %}
                </div>
                <div>
                  <h3>Medium term</h3>
                  {% for it in timeline.t90 %}<p>{{ it }}</p>{% endfor %}
                </div>
                <div>
                  <h3>Long term</h3>
                  {% for it in timeline.t365 %}<p>{{ it }}</p>{% endfor %}
                </div>
              </div>
              {% elif roadmap_items and roadmap_items|length > 0 %}
              <table class="roadmap-table">
                <thead>
                  <tr>
                    <th>Month</th>
                    <th>Task</th>
                    <th>Owner</th>
                    <th>Dependencies</th>
                    <th>Benefit</th>
                  </tr>
                </thead>
                <tbody>
                  {% for item in roadmap_items %}
                  <tr>
                    <td>{{ item.month or '' }}</td>
                    <td>{{ item.task or '' }}</td>
                    <td>{{ item.owner or '' }}</td>
                    <td>{{ item.dependencies or '' }}</td>
                    <td>{{ item.benefit or item.outcome or '' }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              {% else %}
              <div>{{ roadmap_html|safe }}</div>
              {% endif %}
            </div>
          {% endif %}
        </div>

        <!-- Funding programmes (selection) -->
        <div class="section">
          <div class="card" style="page-break-before: always;">
            <h2>Funding programmes</h2>
            {% if foerderprogramme_html and foerderprogramme_html|trim %}
              <div>{{ foerderprogramme_html|safe }}</div>
              <p class="caption">Updated: {{ funding_stand or datum }}</p>
            {% elif dynamic_funding_html and dynamic_funding_html|trim %}
              <div>{{ dynamic_funding_html|safe }}</div>
            {% elif foerderprogramme_table and foerderprogramme_table|length>0 %}
              <table>
                <thead>
                  <tr>
                    <th>Programme</th>
                    <th>Type</th>
                    <th>Who</th>
                    <th>What</th>
                    <th>Max</th>
                    <th>Notes</th>
                    <th>Link</th>
                  </tr>
                </thead>
                <tbody>
                  {% for row in foerderprogramme_table %}
                  <tr>
                    <td>{{ row.name }}</td>
                    <td>{{ row.type }}</td>
                    <td>{{ row.who }}</td>
                    <td>{{ row.what }}</td>
                    <td>{{ row.max }}</td>
                    <td>{{ row.notes }}</td>
                    <td><a href="{{ row.link }}">{{ row.link_label or 'Link' }}</a></td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            {% else %}
              <p>No curated programmes at the moment.</p>
            {% endif %}
    </div>
    </div>
      </div>

      <!-- Charts (offline SVG) -->
      <!--
        (function(){
          const data = ({{ chart_data_json | safe }}) || { score: 0, dimensions:
  { labels: [], values: [] } };

          // Radar (One-pager)
          const rsvg=document.getElementById('radar'), 
L=(data.dimensions&&data.dimensions.labels)||[], 
V=(data.dimensions&&data.dimensions.values)||[], 
R=90,CX=110,CY=110,N=L.length||6;
          const ring=(k)=>`<circle cx="${CX}" cy="${CY}" r="${(R/5)*k}" 
fill="none" stroke="#e5ecf4" stroke-width="1"/>`; let 
grid=Array.from({length:5},(_,i)=>ring(i+1)).join('');
          for(let i=0;i<N;i++){const a=-Math.PI/2+i*(2*Math.PI/N); grid+=`<line 
x1="${CX}" y1="${CY}" x2="${CX+90*Math.cos(a)}" y2="${CY+90*Math.sin(a)}" 
stroke="#e5ecf4" stroke-width="1"/>`;}
          const pts=V.map((v,i)=>{const a=-Math.PI/2+i*(2*Math.PI/N), 
rr=(Math.max(0,Math.min(5,parseFloat(v)||0))/5)*90; return 
`${CX+rr*Math.cos(a)},${CY+rr*Math.sin(a)}`}).join(' ');
          let lbl=''; for(let i=0;i<N;i++){const 
a=-Math.PI/2+i*(2*Math.PI/N),x=CX+(90+12)*Math.cos(a),y=CY+(90+12)*Math.sin(a); 
lbl+=`<text x="${x}" y="${y}" font-size="9" text-anchor="middle" 
fill="#5b6b7a">${L[i]||''}</text>`;}
          rsvg.innerHTML=`${grid}<polygon points="${pts}" 
fill="rgba(31,102,255,0.18)" stroke="#1f66ff" stroke-width="2"/>${lbl}`;
        })();
      -->
    
        <!-- Compliance -->
        {% if compliance_html and compliance_html|trim %}
        <div class="section">
          <div class="card" style="page-break-before: always;">
            <h2>Compliance</h2>
            <div>{{ compliance_html|safe }}</div>
          </div>
        </div>
        {% endif %}
    
    </body>
    </html>