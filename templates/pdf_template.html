<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>{{ (meta|default({})).title|default('KI-Statusbericht', true) }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ===== Gold Standard Design System ===== */
    :root {
      /* Premium Blau-Palette */
      --primary-900: #0A1628;
      --primary-800: #1E3A5F;
      --primary-700: #2C4F7C;
      --primary-600: #3B5998;
      --primary-500: #4A69BD;
      --primary-400: #5B7CCD;
      --primary-300: #7B95E1;
      --primary-200: #A8BFF8;
      --primary-100: #E3ECFF;
      --primary-50:  #F4F7FF;
      
      /* Semantische Farben */
      --success: #10B981;
      --warning: #F59E0B;
      --danger: #EF4444;
      --info: #3B82F6;
      
      /* Layout */
      --page-bg: #FFFFFF;
      --text-primary: #1A202C;
      --text-secondary: #4A5568;
      --text-muted: #718096;
      --border-color: #E2E8F0;
    }

    /* ===== Reset & Base ===== */
    @page { 
      size: A4; 
      margin: 10mm 12mm 15mm 12mm;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
      font-size: 10pt;
      line-height: 1.5;
      color: var(--text-primary);
      background: var(--page-bg);
      -webkit-font-smoothing: antialiased;
    }

    /* ===== Titelseite ===== */
    .cover {
      min-height: 250mm;
      display: flex;
      flex-direction: column;
      justify-content: center;
      background: linear-gradient(135deg, var(--primary-50) 0%, var(--page-bg) 100%);
      page-break-after: always;
      padding: 30px;
      position: relative;
    }
    
    .cover::before {
      content: '';
      position: absolute;
      top: -50px;
      right: -50px;
      width: 250px;
      height: 250px;
      background: radial-gradient(circle, var(--primary-100) 0%, transparent 70%);
      border-radius: 50%;
      opacity: 0.3;
    }
    
    .cover h1 {
      font-size: 36pt;
      font-weight: 700;
      color: var(--primary-800);
      margin-bottom: 10px;
      letter-spacing: -0.5px;
    }
    
    .cover-subtitle {
      font-size: 14pt;
      color: var(--primary-600);
      margin-bottom: 25px;
    }
    
    .cover-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 30px;
    }
    
    .meta-badge {
      display: inline-flex;
      padding: 6px 14px;
      background: var(--page-bg);
      border: 2px solid var(--primary-200);
      border-radius: 20px;
      font-size: 9pt;
      font-weight: 600;
      color: var(--primary-700);
    }
    
    .score-display {
      margin-top: 30px;
      padding: 25px;
      background: var(--page-bg);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      max-width: 350px;
    }
    
    .score-title {
      font-size: 10pt;
      color: var(--text-secondary);
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .score-value {
      font-size: 42pt;
      font-weight: 700;
      color: var(--primary-600);
      line-height: 1;
    }
    
    .score-bar {
      height: 10px;
      background: var(--primary-100);
      border-radius: 5px;
      margin-top: 12px;
      overflow: hidden;
    }
    
    .score-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-400), var(--primary-600));
      border-radius: 5px;
    }

    /* ===== Kapitel-Layout FIXED ===== */
    .chapter {
      page-break-before: always;
      padding: 20px 0;
    }
    
    .chapter:first-of-type {
      page-break-before: auto;
    }
    
    /* KRITISCHER FIX: Keine Grid-Layout für Text */
    .chapter-header {
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 3px solid var(--primary-200);
    }
    
    .chapter-number {
      font-size: 9pt;
      font-weight: 600;
      color: var(--primary-500);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 6px;
    }
    
    .chapter-title {
      font-size: 20pt;
      font-weight: 700;
      color: var(--primary-800);
      line-height: 1.2;
    }
    
    /* Volle Breite für Content */
    .chapter-content {
      width: 100%;
      max-width: 100%;
    }

    /* ===== KPI Dashboard ===== */
    .kpi-dashboard {
      background: linear-gradient(135deg, var(--primary-50) 0%, var(--page-bg) 100%);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    
    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 15px;
    }
    
    .kpi-card {
      background: var(--page-bg);
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid var(--primary-500);
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }
    
    .kpi-label {
      font-size: 8pt;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-bottom: 5px;
    }
    
    .kpi-value {
      font-size: 16pt;
      font-weight: 700;
      color: var(--primary-700);
      line-height: 1;
    }
    
    .kpi-description {
      font-size: 8pt;
      color: var(--text-secondary);
      margin-top: 5px;
    }

    /* ===== Inhaltselemente ===== */
    h2 {
      font-size: 16pt;
      font-weight: 600;
      color: var(--primary-700);
      margin: 18px 0 12px 0;
      page-break-after: avoid;
    }
    
    h3 {
      font-size: 12pt;
      font-weight: 600;
      color: var(--primary-600);
      margin: 15px 0 10px 0;
      page-break-after: avoid;
    }
    
    p {
      margin-bottom: 10px;
      text-align: justify;
      hyphens: auto;
    }
    
    strong {
      font-weight: 600;
      color: var(--primary-800);
    }
    
    a {
      color: var(--primary-600);
      text-decoration: none;
    }

    /* ===== Listen ===== */
    ul, ol {
      margin: 10px 0 10px 20px;
    }
    
    li {
      margin-bottom: 6px;
      line-height: 1.4;
    }

    /* ===== Tabellen ===== */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      font-size: 9pt;
      page-break-inside: avoid;
    }
    
    thead {
      background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
      color: white;
    }
    
    th {
      padding: 10px 12px;
      text-align: left;
      font-weight: 600;
    }
    
    td {
      padding: 8px 12px;
      border-bottom: 1px solid var(--border-color);
    }
    
    tbody tr:nth-child(even) {
      background: var(--primary-50);
    }

    /* ===== Info-Boxen ===== */
    .info-box {
      background: var(--primary-50);
      border: 2px solid var(--primary-200);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      page-break-inside: avoid;
    }
    
    .info-box.success {
      background: #D1FAE5;
      border-color: #10B981;
    }
    
    .info-box.warning {
      background: #FEF3C7;
      border-color: #F59E0B;
    }
    
    .info-box-title {
      font-weight: 600;
      font-size: 10pt;
      margin-bottom: 6px;
      color: var(--primary-800);
    }

    /* ===== Tool & Förder Items ===== */
    .tool-item, .funding-item {
      padding: 10px;
      background: var(--primary-50);
      border-radius: 6px;
      margin-bottom: 10px;
      border-left: 3px solid var(--primary-400);
      page-break-inside: avoid;
    }
    
    .tool-name, .funding-name {
      font-weight: 600;
      color: var(--primary-700);
      font-size: 10pt;
    }
    
    .tool-desc, .funding-desc {
      font-size: 9pt;
      color: var(--text-secondary);
      margin: 3px 0;
    }
    
    .chip {
      display: inline-block;
      padding: 2px 6px;
      background: var(--primary-100);
      color: var(--primary-700);
      border-radius: 10px;
      font-size: 7pt;
      margin-right: 4px;
    }

    /* ===== Fortschrittsbalken ===== */
    .progress-bar {
      height: 6px;
      background: var(--border-color);
      border-radius: 3px;
      overflow: hidden;
      margin: 5px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-400), var(--primary-600));
      border-radius: 3px;
    }

    /* ===== Feedback Section ===== */
    .feedback-section {
      margin-top: 30px;
      padding: 20px;
      background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
      border-radius: 10px;
      color: white;
      text-align: center;
      page-break-inside: avoid;
    }
    
    .feedback-title {
      font-size: 14pt;
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .feedback-text {
      margin-bottom: 15px;
      font-size: 10pt;
    }
    
    .feedback-button {
      display: inline-block;
      padding: 10px 20px;
      background: white;
      color: var(--success);
      border-radius: 6px;
      font-weight: 600;
      text-decoration: none;
      font-size: 10pt;
    }

    /* ===== Footer ===== */
    .footer {
      position: fixed;
      bottom: 8mm;
      left: 12mm;
      right: 12mm;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 8px;
      border-top: 1px solid var(--border-color);
      font-size: 7pt;
      color: var(--text-muted);
    }
    
    .footer-left {
      flex: 1;
    }
    
    .footer-right {
      flex: 1;
      text-align: right;
    }

    /* ===== Print Optimierungen ===== */
    @media print {
      .chapter {
        page-break-before: always;
      }
      
      .info-box, .kpi-card, table, .tool-item, .funding-item {
        page-break-inside: avoid;
      }
      
      a {
        color: var(--primary-700);
      }
    }
  </style>
</head>
<body>

  <!-- Titelseite -->
  <section class="cover">
    <div class="cover-content">
      <h1>{{ (meta|default({})).title|default('KI-Statusbericht', true) }}</h1>
      <div class="cover-subtitle">
        Ihre individuelle Analyse für erfolgreiche KI-Integration
      </div>
      
      <div class="cover-meta">
        {% if now %}<span class="meta-badge">{{ now().strftime('%d.%m.%Y') }}</span>{% endif %}
        {% if branche %}<span class="meta-badge">{{ branche|capitalize }}</span>{% endif %}
        {% if company_size_label %}<span class="meta-badge">{{ company_size_label }}</span>{% endif %}
        {% if bundesland %}<span class="meta-badge">{{ bundesland|upper }}</span>{% endif %}
      </div>
      
      {% if score_percent %}
      <div class="score-display">
        <div class="score-title">Ihr KI-Reifegrad</div>
        <div class="score-value">{{ score_percent }}%</div>
        <div class="score-bar">
          <div class="score-fill" style="width: {{ score_percent }}%"></div>
        </div>
      </div>
      {% endif %}
    </div>
  </section>

  <!-- Executive Summary mit KPIs -->
  {% if exec_summary_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Management Summary</div>
      <h1 class="chapter-title">Ihre KI-Strategie im Überblick</h1>
    </div>
    
    <div class="chapter-content">
      <div class="kpi-dashboard">
        {{ exec_summary_html|safe }}
        
        {% if kpi_efficiency or kpi_cost_saving or kpi_roi_months or kpi_compliance %}
        <div class="kpi-grid">
          <div class="kpi-card">
            <div class="kpi-label">Effizienzpotenzial</div>
            <div class="kpi-value">+{{ kpi_efficiency|default(25) }}%</div>
            <div class="kpi-description">Produktivitätssteigerung möglich</div>
          </div>
          
          <div class="kpi-card">
            <div class="kpi-label">Kosteneinsparung</div>
            <div class="kpi-value">{{ kpi_cost_saving|default(20) }}%</div>
            <div class="kpi-description">{{ roi_annual_saving|default(15000) }} EUR/Jahr</div>
          </div>
          
          <div class="kpi-card">
            <div class="kpi-label">Return on Investment</div>
            <div class="kpi-value">{{ kpi_roi_months|default(8) }} Mon.</div>
            <div class="kpi-description">Zeit bis Break-Even</div>
          </div>
          
          <div class="kpi-card">
            <div class="kpi-label">Compliance-Status</div>
            <div class="kpi-value">{{ kpi_compliance|default(75) }}%</div>
            <div class="kpi-description">DSGVO & EU AI Act Ready</div>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </section>
  {% endif %}

  <!-- Quick Wins -->
  {% if quick_wins_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Sofortmaßnahmen</div>
      <h1 class="chapter-title">Quick Wins für schnelle Erfolge</h1>
    </div>
    
    <div class="chapter-content">
      <div class="info-box success">
        <div class="info-box-title">30-60 Tage zum ersten Erfolg</div>
        Diese Maßnahmen können Sie sofort starten und binnen weniger Wochen erste Ergebnisse sehen.
      </div>
      
      {{ quick_wins_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Risiken -->
  {% if risks_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Risikomanagement</div>
      <h1 class="chapter-title">Risiken erkennen und meistern</h1>
    </div>
    
    <div class="chapter-content">
      {{ risks_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Empfehlungen -->
  {% if recommendations_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Strategische Empfehlungen</div>
      <h1 class="chapter-title">Ihre nächsten Schritte</h1>
    </div>
    
    <div class="chapter-content">
      {{ recommendations_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Roadmap -->
  {% if roadmap_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Implementierung</div>
      <h1 class="chapter-title">Ihre KI-Roadmap</h1>
    </div>
    
    <div class="chapter-content">
      {{ roadmap_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Coaching -->
  {% if coaching_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Coaching</div>
      <h1 class="chapter-title">Impulse für Ihre Transformation</h1>
    </div>
    
    <div class="chapter-content">
      {{ coaching_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Vision & Gamechanger -->
  {% if vision_html or gamechanger_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Vision 2027</div>
      <h1 class="chapter-title">Ihre KI-Zukunft</h1>
    </div>
    
    <div class="chapter-content">
      {% if vision_html %}{{ vision_html|safe }}{% endif %}
      {% if gamechanger_html %}
      <div class="info-box success">
        <div class="info-box-title">Ihr Gamechanger</div>
        {{ gamechanger_html|safe }}
      </div>
      {% endif %}
    </div>
  </section>
  {% endif %}

  <!-- Compliance -->
  {% if compliance_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Rechtssicherheit</div>
      <h1 class="chapter-title">Compliance & Datenschutz</h1>
    </div>
    
    <div class="chapter-content">
      {{ compliance_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Förderprogramme -->
  {% if funding_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Förderung</div>
      <h1 class="chapter-title">Fördermittel für Ihre KI-Projekte</h1>
    </div>
    
    <div class="chapter-content">
      <div class="info-box">
        <div class="info-box-title">Nutzen Sie staatliche Unterstützung</div>
        Diese Programme passen zu Ihrem Unternehmen und Ihren KI-Vorhaben.
      </div>
      {{ funding_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- KI-Tools -->
  {% if tools_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Werkzeuge</div>
      <h1 class="chapter-title">Empfohlene KI-Tools</h1>
    </div>
    
    <div class="chapter-content">
      {{ tools_html|safe }}
    </div>
  </section>
  {% endif %}

  <!-- Live Updates -->
  {% if live_html %}
  <section class="chapter">
    <div class="chapter-header">
      <div class="chapter-number">Aktuelles</div>
      <h1 class="chapter-title">{{ live_title|default('Neue Entwicklungen', true) }}</h1>
    </div>
    
    <div class="chapter-content">
      {{ live_html|safe }}
      <p style="color: var(--text-muted); font-size: 8pt; margin-top: 15px;">
        Stand: {{ now().strftime('%d.%m.%Y') if now else '2025' }}. Änderungen vorbehalten.
      </p>
    </div>
  </section>
  {% endif %}

  <!-- Feedback-Sektion -->
  <section class="chapter">
    <div class="feedback-section">
      <div class="feedback-title">Ihr Feedback ist uns wichtig!</div>
      <div class="feedback-text">
        Helfen Sie uns, diesen Report noch besser zu machen.
        Ihre Rückmeldung hilft anderen Unternehmen bei ihrer KI-Transformation.
      </div>
      <a href="https://make.ki-sicherheit.jetzt/feedback/feedback.html" class="feedback-button">
        Feedback geben →
      </a>
    </div>
    
    <div style="margin-top: 30px; padding: 15px; background: var(--primary-50); border-radius: 8px;">
      <h3 style="color: var(--primary-700); margin-bottom: 10px;">Kontakt & Support</h3>
      <p style="font-size: 9pt;">
        <strong>KI-Sicherheit.jetzt</strong><br/>
        TÜV-zertifiziertes KI-Management<br/>
        E-Mail: info@ki-sicherheit.jetzt<br/>
        Web: www.ki-sicherheit.jetzt
      </p>
    </div>
  </section>

  <!-- Footer auf allen Seiten -->
  <div class="footer">
    <div class="footer-left">
      © {{ copyright_year|default(2025) }} {{ copyright_owner|default('KI-Sicherheit.jetzt') }}
    </div>
    <div class="footer-right">
      DSGVO • EU AI Act • DSA • ePrivacy
    </div>
  </div>

</body>
</html>